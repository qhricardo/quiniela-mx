// Validaciones básicas antes de enviar
function validateEmail(email) {
    return /\S+@\S+\.\S+/.test(email);
}

// LOGIN
document.getElementById('login-btn').addEventListener('click', async () => {
    const email = document.getElementById('login-email').value.trim();
    const password = document.getElementById('login-password').value.trim();
    const message = document.getElementById('login-message');

    if (!validateEmail(email) || !password) {
        showError(message, 'Correo y contraseña requeridos');
        return;
    }

    try {
        await firebase.auth().signInWithEmailAndPassword(email, password);
        window.location.href = "index.html";
    } catch (error) {
        showError(message, error.code);
    }
});

// REGISTRO
document.getElementById('register-btn').addEventListener('click', async () => {
    const name = document.getElementById('register-name').value.trim();
    const email = document.getElementById('register-email').value.trim();
    const password = document.getElementById('register-password').value.trim();
    const message = document.getElementById('register-message');

    if (!name || !validateEmail(email) || password.length < 6) {
        showError(message, 'Todos los campos son obligatorios y la contraseña debe tener al menos 6 caracteres');
        return;
    }

    try {
        const userCredential = await firebase.auth().createUserWithEmailAndPassword(email, password);
        await db.collection('users').doc(userCredential.user.uid).set({
            name,
            email,
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        showSuccess(message, "¡Cuenta creada con éxito! Redirigiendo...");
        setTimeout(() => window.location.href = "index.html", 1500);
    } catch (error) {
        showError(message, error.code);
    }
});
